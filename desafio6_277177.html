<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Joaquim Bertoldi Nucci 277177">

<title>Desafio 6</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="desafio6_277177_files/libs/clipboard/clipboard.min.js"></script>
<script src="desafio6_277177_files/libs/quarto-html/quarto.js"></script>
<script src="desafio6_277177_files/libs/quarto-html/popper.min.js"></script>
<script src="desafio6_277177_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="desafio6_277177_files/libs/quarto-html/anchor.min.js"></script>
<link href="desafio6_277177_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="desafio6_277177_files/libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="desafio6_277177_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="desafio6_277177_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="desafio6_277177_files/libs/bootstrap/bootstrap-1bc8a17f135ab3d594c857e9f48e611b.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Desafio 6</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Joaquim Bertoldi Nucci 277177 </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<p>Questão 1</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>path <span class="ot">=</span> <span class="st">'dados'</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>fname <span class="ot">=</span> <span class="fu">file.path</span>(path, <span class="st">'disco.db'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Questão 2</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RSQLite)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: pacote 'RSQLite' foi compilado no R versão 4.4.3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>conn <span class="ot">=</span> <span class="fu">dbConnect</span>(<span class="fu">SQLite</span>(), fname)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Questão 3</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dbListTables</span>(conn)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "albums"          "artists"         "customers"       "employees"      
 [5] "genres"          "invoice_items"   "invoices"        "media_types"    
 [9] "playlist_track"  "playlists"       "sqlite_sequence" "sqlite_stat1"   
[13] "tracks"         </code></pre>
</div>
</div>
<p>Questão 4</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dbListFields</span>(conn, <span class="st">'customers'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "CustomerId"   "FirstName"    "LastName"     "Company"      "Address"     
 [6] "City"         "State"        "Country"      "PostalCode"   "Phone"       
[11] "Fax"          "Email"        "SupportRepId"</code></pre>
</div>
</div>
<p>Questão 5</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dbGetQuery</span>(conn, <span class="st">'SELECT COUNT(*) FROM customers'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  COUNT(*)
1       59</code></pre>
</div>
</div>
<p>Questão 6</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dbGetQuery</span>(conn, <span class="st">'SELECT COUNT(*) FROM (SELECT DISTINCT country FROM customers)'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  COUNT(*)
1       24</code></pre>
</div>
</div>
<p>Questão 7</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dbGetQuery</span>(conn, <span class="st">'SELECT DISTINCT country, COUNT(*) FROM customers GROUP BY country ORDER BY COUNT(*) DESC'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          Country COUNT(*)
1             USA       13
2          Canada        8
3          France        5
4          Brazil        5
5         Germany        4
6  United Kingdom        3
7        Portugal        2
8           India        2
9  Czech Republic        2
10         Sweden        1
11          Spain        1
12         Poland        1
13         Norway        1
14    Netherlands        1
15          Italy        1
16        Ireland        1
17        Hungary        1
18        Finland        1
19        Denmark        1
20          Chile        1
21        Belgium        1
22        Austria        1
23      Australia        1
24      Argentina        1</code></pre>
</div>
</div>
<p>Questão 8</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dbGetQuery</span>(conn, <span class="st">'SELECT DISTINCT country, COUNT(*) FROM customers GROUP BY country ORDER BY COUNT(*) DESC LIMIT 5'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Country COUNT(*)
1     USA       13
2  Canada        8
3  France        5
4  Brazil        5
5 Germany        4</code></pre>
</div>
</div>
<p>Questão 9</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dbGetQuery</span>(conn, <span class="st">"SELECT DISTINCT country FROM customers WHERE country GLOB '??????'"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Country
1  Brazil
2  Canada
3  Norway
4  France
5  Poland
6  Sweden</code></pre>
</div>
</div>
<p>Questão 10</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>sql1 <span class="ot">=</span> <span class="fu">paste</span>(<span class="st">"SELECT DISTINCT name FROM invoice_items"</span>,</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>           <span class="st">"INNER JOIN tracks ON tracks.trackid=invoice_items.trackid"</span>,</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>           <span class="st">"WHERE invoiceid IN"</span>,</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>           <span class="st">"(SELECT DISTINCT invoiceid FROM customers"</span>,</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>           <span class="st">"INNER JOIN invoices ON invoices.customerid = customers.customerid"</span>,</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>           <span class="st">"WHERE country = 'Brazil')"</span>)</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="fu">dbGetQuery</span>(conn, sql1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                                                                        Name
1                                                                        Admirável Gado Novo
2                                         Mis Penas Lloraba Yo (Ao Vivo) Soy Gitano (Tangos)
3                                                                                    Drifter
4                                                                              Child In Time
5                                                                                   No No No
6                                                                 Knocking At Your Back Door
7                                                                          The Unwritten Law
8                                                                            Maybe I'm A Leo
9                                                                  Vavoom : Ted The Mechanic
10                                                                   Right Next Door to Hell
11                                                                             Dust N' Bones
12                                                                          Live and Let Die
13                                                                             Leper Messiah
14                                                                               Damage Inc.
15                                                                        The Memory Remains
16                                                                         The Unforgiven II
17                                                                                   Slither
18                                                                                  Bad Seed
19                                                                             Green Disease
20                                                                                    Why Go
21                                                                                    Animal
22                                                                                     Leash
23                                                                    Wanted Dread And Alive
24                                                                  The Great Gig In The Sky
25                                                                                     Bossa
26                                                                       Nega Do Cabelo Duro
27                                                                     You're My Best Friend
28                                                                        Seven Seas Of Rhye
29                                                                       Get Down, Make Love
30                                                                                    Get Up
31                                                                                  Untitled
32                                                                                   Be Mine
33                                                                      Black Light Syndrome
34                                                              Midnight From The Inside Out
35                                                                       Sometimes Salvation
36                                                                      Girl From A Pawnshop
37                                                                                Title Song
38                                                                              Soul Singing
39                                                                       Experiment In Terra
40                                                                         Take the Celestra
41                                                                         Shout It Out Loud
42                                                                          Calling Dr. Love
43                                                                                  Strutter
44                                                                                  Cold Gin
45                                                                                 Redundant
46                                                                            Into The Light
47                                                                              Cry For Love
48                                                                           Grito De Alerta
49                                                                        Lindo Lago Do Amor
50                                                                     Ponto De Interrogação
51                                                         Voce Nao Entende Nada - Cotidiano
52                                                                               O Leaozinho
53                                                                                   Top Top
54                                                                            Lay Down Sally
55                                                                           Think About You
56                                                                              Rocket Queen
57                                                                      Don't Cry (Original)
58                                                                            Back off Bitch
59                                                                            Garden of Eden
60                                                                                      Coma
61                                                                              D'Yer Mak'er
62                                                                                No Quarter
63                                                                            In The Evening
64                                                                          Fool In The Rain
65                                         Saudade Dos Aviões Da Panair (Conversando No Bar)
66                                                                    Caso Você Queira Saber
67                                                                                     Dance
68                                                                                 Aos Leões
69                                                                                  Demorou!
70                                                                           Home Sweet Home
71                                                                                     Intro
72                                                                      Scentless Apprentice
73                                                                                  In Bloom
74                                                                                On A Plain
75                                                                                  Mundaréu
76                                                                    Nossa Gente (Avisa Là)
77                                                                            Revolta Olodum
78                                                                                 Vai Valer
79                                                                            Bittersweet Me
80                                                                         Binky The Doormat
81                                                                          So Fast, So Numb
82                                                                               Electrolite
83                                                                  All Along The Watchtower
84                                                                                       Bad
85                                                                            Sweetest Thing
86                                                                         All I Want Is You
87                                                                            Like A Song...
88                                                                                 Red Light
89                                                                                  Babyface
90                                                                                Vai Passar
91                                                                          Morena De Angola
92                                                                            Meu Caro Amigo
93                                                                              Mateus Enter
94                                                                             Samba Do Lado
95                                                                     Um Satélite Na Cabeça
96                                                                             Amor De Muito
97                                                                 Banditismo Por Uma Questa
98                                                                 Maracatu De Tiro Certeiro
99                                                                                 Aces High
100                                                                    2 Minutes To Midnight
101                                                                             Losfer Words
102                                                                                 Duelists
103                                                                               Powerslave
104                                                                                    Aloha
105                                                                                     Será
106                                                                            Pais E Filhos
107                                                                    Rock And Roll Is Dead
108                                                                          I Belong To You
109                                                                                     Casa
110                                                                                   A Cura
111                                                                                   Sereia
112                                                Heart Of Lothian: Wide Boy / Curtain Call
113                                                                       Cérebro Eletrônico
114                                                                           A Menina Dança
115                                                           You've Been A Long Time Coming
116                                                                 Abraham, Martin And John
117                                                                        Everything I Need
118                                                                                Bora-Bora
119                                                        I Feel Good (I Got You) - Sossego
120                                                                             Sincero Breu
121                                                                                 Selvagem
122                                                             O Descobridor Dos Sete Mares
123                                                                            Não Vou Ficar
124                                                                            Cristina Nº 2
125                                                                         O Que Me Importa
126                                                                              Eu Amo Você
127                                                                              Nosso Adeus
128                                     Karelia Suite, Op.11: 2. Ballade (Tempo Di Menuetto)
129                                                                 Fantasia On Greensleeves
130                                                                            Help Yourself
131                                          Suite No. 3 in D, BWV 1068: III. Gavotte I &amp; II
132 Music for the Funeral of Queen Mary: VI. "Thou Knowest, Lord, the Secrets of Our Hearts"
133       Symphony No. 2, Op. 16 -  "The Four Temperaments": II. Allegro Comodo e Flemmatico
134     String Quartet No. 12 in C Minor, D. 703 "Quartettsatz": II. Andante - Allegro assai
135                                                                          Fast As a Shark
136                                                                               Snowballed
137                                                                                  Go Down
138                                                             Hell Ain't A Bad Place To Be
139                                                                          Interlude Zumbi
140                                                                 Rios Pontes &amp; Overdrives
141                                                                           Lixo Do Mangue
142                                                                               Podes Crer
143                                                                             A Cor Do Sol
144                                                                                   Doutor
145                                                                         Linha Do Equador
146                                                                               TriboTchan
147                                                                             Reggae Tchan
148                                                               Communication Breakdown(2)
149                                                               Carolina Hard-Core Ecstasy
150                                                                                 X-9 2001
151                                                                            Ipiranga 2001
152                                                                            Água de Beber
153                                                                      Is This Love (Live)
154                                                                        Stir It Up (Live)
155                                                                          Refavela (Live)
156                                                                                   Praise
157                                                                               Down Under
158                                                                           Be Good Johnny
159                                                                          Down by the Sea
160                                                                           It's a Mistake
161                                                                       Shakes and Ladders
162                                                                           Vamo Batê Lata
163                                                                  Mensagen De Amor (2000)
164                                                                               Saber Amar
165                                                                              Cinema Mudo
166                                                                                 Meu Erro
167                                                                     Será Que Vai Chover?
168                                                                    Mama, I'm Coming Home
169                                                                        Flying High Again
170                                                                                 Paranoid
171                                                                                Most High
172                                                                           Your Blue Room
173                                                                                 Plot 180
174                                                                                Sanctuary
175                                                                                    Black
176                                                                                 Big Wave
177                                                                               Cropduster
178                                                                                 1/2 Full
179                                                                                   Oceans
180                                                                                Dissident
181                                                                          Don't Look Back
182                                                                           Pick Myself Up
183                                                                      Any Colour You Like
184                                                                                      Eye
185                                                                   Stand Inside Your Love
186                                                                                   Flower
187                                                                        Jesus Christ Pose
188                                                                  The Day I Tried To Live
189                                                                        Burden In My Hand</code></pre>
</div>
</div>
<p>Qual o álbum mais tocado por pais?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>sql2 <span class="ot">=</span> <span class="st">"SELECT country, title FROM (SELECT c.country, a.title,</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="st">    COUNT(*) AS play_count FROM customers c</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="st">    JOIN invoices i ON c.customerid = i.customerid</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="st">    JOIN invoice_items ii ON i.invoiceid = ii.invoiceid</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="st">    JOIN tracks t ON ii.trackid = t.trackid</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="st">    JOIN albums a ON t.albumid = a.albumid</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="st">  GROUP BY c.country, a.title</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="st">  ORDER BY c.country, play_count DESC) </span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="st">  GROUP BY country"</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="fu">dbGetQuery</span>(conn, sql2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          country                                      title
1       Argentina                                   Acústico
2       Australia                               The X Factor
3         Austria   My Generation - The Very Best Of The Who
4         Belgium               Rotten Apples: Greatest Hits
5          Brazil                        Use Your Illusion I
6          Canada                                 Arquivo II
7           Chile My Way: The Best Of Frank Sinatra [Disc 1]
8  Czech Republic                               Prenda Minha
9         Denmark                                  Mezmerize
10        Finland                              Greatest Kiss
11         France                             Minha Historia
12        Germany                                  Unplugged
13        Hungary                                        Pop
14          India                                Up An' Atom
15        Ireland                             Lost, Season 2
16          Italy                                   Acústico
17    Netherlands                                    In Step
18         Norway      For Those About To Rock We Salute You
19         Poland                             Rattle And Hum
20       Portugal                                Raul Seixas
21          Spain   My Generation - The Very Best Of The Who
22         Sweden                                Volume Dois
23            USA                       The Office, Season 3
24 United Kingdom                    No Prayer For The Dying</code></pre>
</div>
</div>
<p>Qual o artista mais tocado por pais?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>sql3 <span class="ot">=</span> <span class="st">"SELECT country, name FROM (SELECT c.country, ar.name,</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="st">    COUNT(*) AS play_count FROM customers c</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="st">    JOIN invoices i ON c.customerid = i.customerid</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="st">    JOIN invoice_items ii ON i.invoiceid = ii.invoiceid</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="st">    JOIN tracks t ON ii.trackid = t.trackid</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="st">    JOIN albums a ON t.albumid = a.albumid</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="st">    JOIN artists ar ON a.artistid = ar.artistid</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a><span class="st">  GROUP BY c.country, ar.name</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a><span class="st">  ORDER BY c.country, play_count DESC) </span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a><span class="st">  GROUP BY country"</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a><span class="fu">dbGetQuery</span>(conn, sql3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          country                         name
1       Argentina                    Metallica
2       Australia                  Iron Maiden
3         Austria                           U2
4         Belgium                Faith No More
5          Brazil                    Pearl Jam
6          Canada      Os Paralamas Do Sucesso
7           Chile                 Led Zeppelin
8  Czech Republic                           U2
9         Denmark Creedence Clearwater Revival
10        Finland                    Van Halen
11         France Creedence Clearwater Revival
12        Germany                  Iron Maiden
13        Hungary                   The Office
14          India                  Iron Maiden
15        Ireland                         Lost
16          Italy           The Rolling Stones
17    Netherlands        Red Hot Chili Peppers
18         Norway                 Led Zeppelin
19         Poland                           U2
20       Portugal                  Iron Maiden
21          Spain                    Pearl Jam
22         Sweden                        Titãs
23            USA                  Iron Maiden
24 United Kingdom                    Metallica</code></pre>
</div>
</div>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>